<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Numérion Éducation™ — Demande d'audit de trésorerie numérique</title>
  <meta name="description" content="Formulaire d'audit de trésorerie numérique et simulation IA pour directions financières, comités d'audit et comités de direction." />
  <meta name="theme-color" content="#020617" />

  <style>
    /* ========= RESET / BASE ========= */
    *, *::before, *::after { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
                   "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0f172a 0, #020617 46%, #020617 100%);
      color: #0f172a;
    }
    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 1.5rem 1rem 2.5rem;
    }

    /* ========= PAGE SHELL ========= */
    .page-shell {
      width: 100%;
      max-width: 980px;
      margin: 0 auto;
    }

    .brand-signature {
      text-align: center;
      margin-bottom: 0.4rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      font-size: 0.7rem;
      color: #9ca3af;
    }

    .page-header {
      text-align: center;
      color: #e5e7eb;
      margin-bottom: 1.5rem;
    }
    .page-title {
      font-size: clamp(1.8rem, 3vw, 2.1rem);
      font-weight: 650;
      letter-spacing: 0.03em;
    }
    .page-subtitle {
      font-size: 0.9rem;
      color: #9ca3af;
      margin-top: 0.4rem;
    }

    /* ========= TYPO & UTILITAIRES ========= */
    .small { font-size: 0.85rem; }
    .muted { color: #6b7280; }
    .label {
      font-size: 0.9rem;
      font-weight: 600;
      color: #111827;
    }
    .hint {
      font-size: 0.72rem;
      color: #9ca3af;
    }
    .grid {
      display: grid;
    }
    @media (min-width: 720px) {
      .grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    /* ========= CARDS ========= */
    .card{
      border-radius: 1.3rem;
      border: 1px solid rgba(15,23,42,0.12);
      background: rgba(248,250,252,0.98);
      backdrop-filter: blur(14px);
      padding: 1.5rem 1.6rem;
      box-shadow: 0 20px 45px rgba(15,23,42,0.25);
      margin-inline: auto;
    }
    #form-audit.card {
      margin-top: 1.5rem;
    }

    /* ========= FORM & CHAMPS ========= */
    form {
      width: 100%;
    }
    label {
      color: #111827;
    }
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    select,
    textarea {
      width: 100%;
      padding: 0.55rem 0.6rem;
      border-radius: 0.55rem;
      border: 1px solid #d1d5db;
      font-size: 0.85rem;
      font-family: inherit;
      color: #111827;
      background-color: #ffffff;
      outline: none;
      transition: border-color 0.16s ease, box-shadow 0.16s ease, background-color 0.16s ease;
    }
    input::placeholder,
    textarea::placeholder {
      color: #9ca3af;
    }
    input:focus,
    select:focus,
    textarea:focus {
      border-color: #16a34a;
      box-shadow: 0 0 0 1px rgba(22,163,74,0.4);
      background-color: #f9fafb;
    }
    textarea {
      resize: vertical;
    }

    /* ========= BOUTONS ========= */
    .btn{
      border-radius: 999px;
      padding: 0.6rem 1.2rem;
      font-size: 0.85rem;
      font-weight: 500;
      border: 1px solid transparent;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.35rem;
      transition: background-color 0.18s ease, color 0.18s ease,
                  border-color 0.18s ease, box-shadow 0.18s ease,
                  transform 0.08s ease;
      white-space: nowrap;
    }
    .btn:active {
      transform: translateY(1px);
    }
    .btn-light{
      background:#f9fafb;
      color:#111827;
      border-color:#e5e7eb;
    }
    .btn-light:hover{
      background:#f3f4f6;
      box-shadow:0 8px 25px rgba(15,23,42,0.05);
    }
    .btn-dark{
      background:#020617;
      color:#f9fafb;
      border-color:#0f172a;
    }
    .btn-dark:hover{
      background:#020617;
      box-shadow:0 10px 30px rgba(15,23,42,0.32);
    }
    .btn-green{
      background:#16a34a;
      color:#ecfdf3;
      border-color:#16a34a;
    }
    .btn-green:hover{
      background:#15803d;
      border-color:#15803d;
      box-shadow:0 12px 35px rgba(22,163,74,0.45);
    }
    .btn[disabled],
    .btn[disabled]:hover {
      opacity: 0.5;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    /* ========= PROGRESSION WIZARD ========= */
    .wizard-progress{
      margin-top: 1rem;
      margin-bottom: 1.1rem;
    }
    .wizard-progress-bar{
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background:#e5e7eb;
      overflow:hidden;
    }
    .wizard-progress-bar-fill{
      height:100%;
      border-radius:999px;
      background:linear-gradient(90deg,#16a34a,#0f766e);
      transition:width .25s ease-out;
    }
    .wizard-steps-labels{
      display:flex;
      justify-content:space-between;
      gap:.3rem;
      margin-top:.4rem;
    }
    .wizard-step-label{
      flex:1;
      text-align:center;
      font-size:.7rem;
      color:#9ca3af;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      padding:.25rem .4rem;
      border-radius:999px;
    }
    .wizard-step-label.is-active{
      color:#16a34a;
      font-weight:700;
      background:rgba(22,163,74,0.08);
    }

    .wizard-step{
      display:none;
      outline:none;
      border-radius:1rem;
      border:1px solid #e5e7eb;
      background:#ffffff;
      padding:1rem 1rem 1.1rem;
      margin-top:.35rem;
    }
    .wizard-step.is-active{
      display:block;
      box-shadow:0 10px 30px rgba(15,23,42,0.08);
      border-color:rgba(22,163,74,0.18);
    }

    .wizard-checkbox-grid{
      display:grid;
      gap:.25rem;
    }
    .wizard-checkbox-grid label {
      display: flex;
      gap: 0.45rem;
      align-items: flex-start;
    }
    .wizard-checkbox-grid input[type="checkbox"] {
      margin-top: 0.1rem;
    }

    .wizard-summary{
      border-radius:.75rem;
      border:1px solid #e5e7eb;
      background:#f9fafb;
      padding:.75rem .9rem;
      font-size:.8rem;
      color:#4b5563;
    }
    .wizard-summary-title{
      font-weight:600;
      margin-bottom:.35rem;
      color:#111827;
    }
    .wizard-summary-list{
      margin:0;
      padding-left:1.1rem;
      display:grid;
      gap:.1rem;
    }

    .wizard-nav{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:.5rem;
      gap:.75rem;
      flex-wrap:wrap;
    }

    /* ========= RESPONSIVE ========= */
    @media (max-width: 720px){
      body {
        padding: 1.1rem 0.7rem 2.2rem;
      }
      .card{
        padding:1.25rem 1.1rem;
        box-shadow:0 14px 35px rgba(15,23,42,0.35);
      }
      .wizard-steps-labels{display:none}
      .wizard-progress-bar{height:5px}
      .wizard-step{padding:.85rem .85rem 1rem}
      .wizard-nav {
        flex-direction: column;
        align-items: stretch;
      }
      .wizard-nav .btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="page-shell">

    <!-- Signature Numérion -->
    <div class="brand-signature">Numérion Éducation™</div>

    <header class="page-header">
      <h1 class="page-title">Demande d'audit de trésorerie numérique</h1>
      <p class="page-subtitle">
        Formulaire structuré pour directions financières, comités d’audit et comités de direction.
      </p>
    </header>

    <!-- ===================== BLOC INTRO AUDIT & SIMULATION IA ===================== -->
    <section class="card" style="max-width:880px">
      <div class="label">Audit de trésorerie numérique &amp; Simulation IA — Numérion Éducation™</div>
      <p class="muted small" style="margin-top:.35rem;margin-bottom:.75rem">
        3 livrables opérationnels · adaptés aux échanges avec vos auditeurs et votre board.
      </p>

      <div class="grid" style="gap:1rem;align-items:flex-start">
        <div style="display:grid;gap:.35rem">
          <div class="small" style="font-weight:600">Vous recevez un livrable “board-ready” :</div>
          <ul class="small muted" style="margin:0;padding-left:1.2rem;display:grid;gap:.15rem">
            <li>Note de cadrage stratégique &amp; synthèse exécutive.</li>
            <li>Simulation chiffrée de poche de trésorerie numérique.</li>
            <li>Matrice risques &amp; gouvernance (dossier opposable audit).</li>
          </ul>
        </div>
        <div style="display:grid;gap:.35rem">
          <div class="small" style="font-weight:600">Cadre &amp; conformité :</div>
          <ul class="small muted" style="margin:0;padding-left:1.2rem;display:grid;gap:.15rem">
            <li>Approche alignée MiCA &amp; IFRS (périmètre informatif).</li>
            <li>Onboarding possible via PSAN/PSCA régulés AMF.</li>
            <li>Aucune détention de fonds, aucun ordre transmis.</li>
          </ul>
        </div>
      </div>

      <div class="small muted" style="margin-top:.8rem;border-top:1px solid #e5e7eb;padding-top:.5rem">
        Confidentialité : les informations transmises sont utilisées exclusivement pour produire votre audit
        et ne sont jamais partagées à des tiers sans votre accord écrit.
      </div>
    </section>

    <!-- ===================== WIZARD AUDIT & SIMULATION IA ===================== -->
    <section id="form-audit" class="card" style="max-width:880px">
      <div class="label">Formulaire d'audit &amp; Simulation IA</div>
      <p class="muted small" style="margin-top:.3rem;margin-bottom:1rem">
        5 étapes guidées · 3 à 5 minutes · Dossier exploitable en comité de direction.
      </p>

      <!-- Progression visuelle -->
      <div class="wizard-progress" aria-hidden="true">
        <div class="wizard-progress-bar">
          <div class="wizard-progress-bar-fill" id="wizardProgressFill" style="width:20%"></div>
        </div>
        <div class="wizard-steps-labels">
          <span class="wizard-step-label is-active">1. Identité</span>
          <span class="wizard-step-label">2. Structure</span>
          <span class="wizard-step-label">3. Trésorerie</span>
          <span class="wizard-step-label">4. Gouvernance</span>
          <span class="wizard-step-label">5. Contexte</span>
        </div>
      </div>

      <form
        id="auditWizardForm"
        action="https://formspree.io/f/mgvrjwqa"
        method="POST"
        novalidate
        style="margin-top:1.5rem;display:flex;flex-direction:column;gap:1.25rem"
      >
        <!-- Honeypot anti-bot -->
        <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off">

        <!-- Métadonnées Formspree -->
        <input type="hidden" name="_subject" value="Audit &amp; Simulation IA — Numérion Éducation" />
        <!-- Redirection vers la page de remerciement dédiée -->
        <input type="hidden" name="_redirect" value="https://numerion.super.site/merci-audit" />

        <!-- Métadonnées internes Numérion -->
        <input type="hidden" name="Wizard version" value="V4 board-ready">
        <input type="hidden" name="Date d’envoi" id="wizardSubmitDate">
        <input type="hidden" name="Source" id="wizardSource" value="">
        <input type="hidden" name="Score maturité" id="wizardMaturityScore" value="">
        <input type="hidden" name="Segment" id="wizardSegment" value="">

        <!-- ========== ÉTAPE 1 : IDENTITÉ & CONTACT ========== -->
        <section class="wizard-step is-active" data-step="1" aria-label="Étape 1 — Identité & contact" tabindex="-1">
          <div class="label muted" style="margin-bottom:.4rem;display:flex;align-items:center;gap:.4rem">
            <span style="
              display:inline-flex;
              width:.5rem;
              height:.5rem;
              border-radius:999px;
              background:linear-gradient(120deg,#16a34a,#0f766e);
            "></span>
            <span>Étape 1/5 — Identité &amp; contact décisionnel</span>
          </div>
          <p class="muted small" style="margin-top:0;margin-bottom:1rem">
            Nous identifions qui porte la décision et comment vous joindre pour la restitution.
          </p>

          <div class="grid" style="gap:1rem">
            <div style="display:grid;gap:.4rem">
              <label for="role" class="small" style="font-weight:700">Rôle principal</label>
              <select name="Rôle" id="role" required>
                <option value="">Sélectionner…</option>
                <option>Direction générale (DG / CEO)</option>
                <option>Direction financière / DAF</option>
                <option>Expert-comptable interne</option>
                <option>Associé / Fondateur</option>
                <option>Autre (mandat / conseil)</option>
              </select>
            </div>

            <div style="display:grid;gap:.4rem">
              <label for="nomSoc" class="small" style="font-weight:700">Nom &amp; société</label>
              <input
                id="nomSoc"
                name="Nom et Société"
                type="text"
                placeholder="Ex : T. Garcia – Durand Industrie"
                autocomplete="organization"
                required
              />
              <p class="hint">Indiquez la personne référente et la dénomination sociale.</p>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.5rem">
            <div style="display:grid;gap:.4rem">
              <label for="emailPro" class="small" style="font-weight:700">Email professionnel</label>
              <input
                id="emailPro"
                name="email"
                type="email"
                placeholder="prenom.nom@societe.fr"
                autocomplete="email"
                required
              />
            </div>
            <div style="display:grid;gap:.4rem">
              <label for="tel" class="small" style="font-weight:700">Téléphone (optionnel)</label>
              <input
                id="tel"
                name="Téléphone"
                type="tel"
                placeholder="+33 ..."
                autocomplete="tel"
                pattern="^\+?[0-9\s\-]{7,}$"
              />
              <p class="hint">Facilite l’organisation rapide de la visio si nécessaire.</p>
            </div>
          </div>
        </section>

        <!-- ========== ÉTAPE 2 : STRUCTURE & RÉFÉRENTIEL ========== -->
        <section class="wizard-step" data-step="2" aria-label="Étape 2 — Structure & référentiel" tabindex="-1">
          <div class="label muted" style="margin-bottom:.4rem;display:flex;align-items:center;gap:.4rem">
            <span style="
              display:inline-flex;
              width:.5rem;
              height:.5rem;
              border-radius:999px;
              background:linear-gradient(120deg,#16a34a,#0f766e);
            "></span>
            <span>Étape 2/5 — Structure &amp; référentiel comptable</span>
          </div>
          <p class="muted small" style="margin-top:0;margin-bottom:1rem">
            Ces éléments structurent l’analyse de bilan et le langage utilisé avec vos auditeurs.
          </p>

          <div class="grid" style="gap:1rem">
            <div style="display:grid;gap:.4rem">
              <label for="secteur" class="small" style="font-weight:700">Secteur d’activité</label>
              <select id="secteur" name="Secteur d’activité" required>
                <option value="">Sélectionner…</option>
                <option>Industrie</option>
                <option>Services</option>
                <option>Technologie</option>
                <option>Énergie</option>
                <option>Immobilier</option>
                <option>Commerce / Distribution</option>
                <option>Autre</option>
              </select>
            </div>

            <div style="display:grid;gap:.4rem">
              <label for="taille" class="small" style="font-weight:700">Taille de l’entreprise</label>
              <select id="taille" name="Taille entreprise" required>
                <option value="">Sélectionner…</option>
                <option>&lt; 50 salariés</option>
                <option>50–250 salariés</option>
                <option>&gt; 250 salariés</option>
              </select>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.75rem">
            <div style="display:grid;gap:.4rem">
              <label for="formeJuridique" class="small" style="font-weight:700">Forme juridique</label>
              <select id="formeJuridique" name="Forme juridique">
                <option value="">Sélectionner…</option>
                <option>SAS</option>
                <option>SA</option>
                <option>SARL</option>
                <option>SCI</option>
                <option>Association</option>
                <option>Autre</option>
              </select>
            </div>
            <div style="display:grid;gap:.4rem">
              <label for="caAnnuel" class="small" style="font-weight:700">Chiffre d’affaires annuel (fourchette)</label>
              <select id="caAnnuel" name="Chiffre d’affaires annuel">
                <option value="">Sélectionner…</option>
                <option>&lt; 5 M€</option>
                <option>5–20 M€</option>
                <option>20–100 M€</option>
                <option>&gt; 100 M€</option>
              </select>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.75rem">
            <div style="display:grid;gap:.4rem">
              <label for="compta" class="small" style="font-weight:700">Référentiel comptable</label>
              <select id="compta" name="Référentiel comptable" required>
                <option value="">Sélectionner…</option>
                <option>IFRS</option>
                <option>French GAAP</option>
                <option>US GAAP</option>
                <option>Autre / non précisé</option>
              </select>
            </div>
            <div style="display:grid;gap:.4rem">
              <label for="juridiction" class="small" style="font-weight:700">Pays / juridiction principale</label>
              <select id="juridiction" name="Pays / juridiction">
                <option value="">Sélectionner…</option>
                <option>France (zone euro)</option>
                <option>Union européenne (hors France)</option>
                <option>Royaume-Uni</option>
                <option>Suisse</option>
                <option>États-Unis</option>
                <option>Autre</option>
              </select>
              <p class="hint">Juridiction principale de la société auditée.</p>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.75rem">
            <div style="display:grid;gap:.4rem">
              <label for="perimetreAudit" class="small" style="font-weight:700">Périmètre de l’audit</label>
              <select id="perimetreAudit" name="Périmètre de l’audit">
                <option value="">Sélectionner…</option>
                <option>Entité seule</option>
                <option>Périmètre consolidé</option>
                <option>Holding de tête</option>
                <option>Filiale spécifique</option>
              </select>
            </div>
            <div style="display:grid;gap:.4rem">
              <label for="cac" class="small" style="font-weight:700">Présence d’un commissaire aux comptes</label>
              <select id="cac" name="Commissaire aux comptes">
                <option value="">Sélectionner…</option>
                <option>Oui</option>
                <option>Non</option>
                <option>En cours de nomination</option>
              </select>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.75rem">
            <div style="display:grid;gap:.4rem">
              <label for="groupe" class="small" style="font-weight:700">Appartenance à un groupe</label>
              <select id="groupe" name="Appartenance groupe">
                <option value="">Sélectionner…</option>
                <option>Indépendant</option>
                <option>Filiale d’un groupe</option>
                <option>Holding de tête</option>
              </select>
            </div>
            <div style="display:grid;gap:.4rem">
              <label for="nomGroupe" class="small" style="font-weight:700">Nom du groupe (si applicable)</label>
              <input
                id="nomGroupe"
                name="Nom groupe"
                type="text"
                placeholder="Nom du groupe / holding"
              />
            </div>
          </div>
        </section>

        <!-- ========== ÉTAPE 3 : TRÉSORERIE & ALLOCATION ========== -->
        <section class="wizard-step" data-step="3" aria-label="Étape 3 — Trésorerie & allocation" tabindex="-1">
          <div class="label muted" style="margin-bottom:.4rem;display:flex;align-items:center;gap:.4rem">
            <span style="
              display:inline-flex;
              width:.5rem;
              height:.5rem;
              border-radius:999px;
              background:linear-gradient(120deg,#16a34a,#0f766e);
            "></span>
            <span>Étape 3/5 — Trésorerie &amp; poche stratégique</span>
          </div>
          <p class="muted small" style="margin-top:0;margin-bottom:1rem">
            Nous cadrons les ordres de grandeur et l’horizon de votre poche de trésorerie numérique.
          </p>

          <div class="grid" style="gap:1rem">
            <div style="display:grid;gap:.4rem">
              <label for="tresoEst" class="small" style="font-weight:700">Trésorerie disponible estimée</label>
              <select id="tresoEst" name="Trésorerie disponible" required>
                <option value="">Sélectionner…</option>
                <option>&lt; 300 000 €</option>
                <option>300 000 € – 1 M€</option>
                <option>1 M€ – 5 M€</option>
                <option>&gt; 5 M€</option>
              </select>
              <p class="hint">Fourchette globale en fin de mois, hors lignes de crédit.</p>
            </div>

            <div style="display:grid;gap:.4rem">
              <label for="alloc" class="small" style="font-weight:700">Allocation crypto envisagée</label>
              <select id="alloc" name="Allocation envisagée" required>
                <option value="">Sélectionner…</option>
                <option>1 % (couverture inflation)</option>
                <option>3 % (poche stratégique)</option>
                <option>5 % (thèse long terme)</option>
                <option>Non défini / Besoin d’aide</option>
              </select>
              <p class="hint">Nous validons ensuite la cohérence avec votre profil de risque.</p>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.5rem">
            <div style="display:grid;gap:.4rem">
              <label for="horizon" class="small" style="font-weight:700">Horizon de la poche</label>
              <select id="horizon" name="Horizon financier" required>
                <option value="">Sélectionner…</option>
                <option>12 mois</option>
                <option>24 mois</option>
                <option>&gt; 24 mois</option>
              </select>
            </div>
            <div style="display:grid;gap:.4rem">
              <label for="rendementCible" class="small" style="font-weight:700">Objectif de rendement annuel cible</label>
              <select id="rendementCible" name="Rendement cible annuel">
                <option value="">Sélectionner…</option>
                <option>&lt; 5 %</option>
                <option>5–10 %</option>
                <option>10–15 %</option>
                <option>&gt; 15 %</option>
                <option>Non défini / Besoin d’aide</option>
              </select>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.75rem">
            <div style="display:grid;gap:.4rem">
              <label for="volatilite" class="small" style="font-weight:700">Tolérance à la volatilité</label>
              <select id="volatilite" name="Tolérance volatilité">
                <option value="">Sélectionner…</option>
                <option>Très faible (priorité capital préservé)</option>
                <option>Modérée (rendement / risque équilibré)</option>
                <option>Élevée (vision très long terme, forte conviction)</option>
              </select>
            </div>
            <div style="display:grid;gap:.4rem">
              <label for="expositionActuelle" class="small" style="font-weight:700">Exposition numérique actuelle</label>
              <select id="expositionActuelle" name="Exposition numérique actuelle">
                <option value="">Sélectionner…</option>
                <option>Aucune exposition</option>
                <option>Exposition limitée &amp; non structurée</option>
                <option>Exposition significative déjà en place</option>
              </select>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.75rem">
            <div style="display:grid;gap:.4rem">
              <span class="small" style="font-weight:700">Univers d’actifs envisagé</span>
              <div class="wizard-checkbox-grid">
                <label class="small">
                  <input type="checkbox" name="Univers d’actifs[]" value="BTC / ETH">
                  BTC / ETH
                </label>
                <label class="small">
                  <input type="checkbox" name="Univers d’actifs[]" value="Stablecoins (EUR / USD)">
                  Stablecoins (EUR / USD)
                </label>
                <label class="small">
                  <input type="checkbox" name="Univers d’actifs[]" value="Autres crypto-actifs (top 20)">
                  Autres crypto-actifs (top 20)
                </label>
                <label class="small">
                  <input type="checkbox" name="Univers d’actifs[]" value="Token spécifiques liés à l’activité">
                  Token spécifiques liés à l’activité
                </label>
              </div>
            </div>
            <div style="display:grid;gap:.4rem">
              <label for="usagePoche" class="small" style="font-weight:700">Usage principal de la poche numérique</label>
              <select id="usagePoche" name="Usage principal">
                <option value="">Sélectionner…</option>
                <option>Couverture de l’inflation</option>
                <option>Diversification de trésorerie</option>
                <option>Rendement (staking / intérêts)</option>
                <option>Intégration métier (paiements, rewards, etc.)</option>
              </select>
            </div>
          </div>
        </section>

        <!-- ========== ÉTAPE 4 : GOUVERNANCE & CONFORMITÉ ========== -->
        <section class="wizard-step" data-step="4" aria-label="Étape 4 — Gouvernance & conformité" tabindex="-1">
          <div class="label muted" style="margin-bottom:.4rem;display:flex;align-items:center;gap:.4rem">
            <span style="
              display:inline-flex;
              width:.5rem;
              height:.5rem;
              border-radius:999px;
              background:linear-gradient(120deg,#16a34a,#0f766e);
            "></span>
            <span>Étape 4/5 — Gouvernance &amp; conformité</span>
          </div>
          <p class="muted small" style="margin-top:0;margin-bottom:1rem">
            Ces points structurent le dossier « opposable audit » et la communication avec vos auditeurs.
          </p>

          <div class="grid" style="gap:1rem">
            <div style="display:grid;gap:.4rem">
              <label for="custody" class="small" style="font-weight:700">Mode de conservation envisagé</label>
              <select id="custody" name="Mode de conservation" required>
                <option value="">Sélectionner…</option>
                <option>PSAN agréé AMF</option>
                <option>Custody interne / cold wallet</option>
                <option>Mixte (PSAN + conservation interne)</option>
                <option>À définir</option>
              </select>
            </div>

            <div style="display:grid;gap:.4rem">
              <label for="maturity" class="small" style="font-weight:700">Niveau de conformité interne MiCA</label>
              <select id="maturity" name="Conformité MiCA" required>
                <option value="">Sélectionner…</option>
                <option>Aucune</option>
                <option>Partielle</option>
                <option>Complète</option>
              </select>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.5rem">
            <div style="display:grid;gap:.4rem">
              <label for="urgence" class="small" style="font-weight:700">Niveau d'urgence</label>
              <select id="urgence" name="Urgence" required>
                <option value="">Sélectionner…</option>
                <option>Étude / cadrage interne</option>
                <option>Instruction board / comité déjà lancée</option>
                <option>Exécution dans les 30 jours</option>
              </select>
            </div>

            <div style="display:grid;gap:.4rem">
              <label for="decisionScope" class="small" style="font-weight:700">Portée de la décision</label>
              <select id="decisionScope" name="Portée de la décision">
                <option value="">Sélectionner…</option>
                <option>Exploration / cadrage</option>
                <option>Décision stratégique à acter</option>
                <option>Mise en conformité d’une situation existante</option>
              </select>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.75rem">
            <div style="display:grid;gap:.4rem">
              <label for="signataires" class="small" style="font-weight:700">Nombre de signataires impliqués</label>
              <select id="signataires" name="Nombre de signataires">
                <option value="">Sélectionner…</option>
                <option>1 (décisionnaire unique)</option>
                <option>2 (duo décisionnel)</option>
                <option>Collégial (board / comité)</option>
              </select>
            </div>
            <div style="display:grid;gap:.4rem">
              <span class="small" style="font-weight:700">Contraintes internes identifiées</span>
              <div class="wizard-checkbox-grid">
                <label class="small">
                  <input type="checkbox" name="Contraintes internes[]" value="Réserves du commissaire aux comptes">
                  Réserves du commissaire aux comptes
                </label>
                <label class="small">
                  <input type="checkbox" name="Contraintes internes[]" value="Réticence du board">
                  Réticence du board
                </label>
                <label class="small">
                  <input type="checkbox" name="Contraintes internes[]" value="Manque de temps / ressources internes">
                  Manque de temps / ressources internes
                </label>
                <label class="small">
                  <input type="checkbox" name="Contraintes internes[]" value="Manque de référentiel clair">
                  Manque de référentiel clair
                </label>
              </div>
            </div>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.75rem">
            <div style="display:grid;gap:.4rem">
              <label for="polTreso" class="small" style="font-weight:700">Politique de trésorerie formalisée</label>
              <select id="polTreso" name="Politique de trésorerie">
                <option value="">Sélectionner…</option>
                <option>Aucune</option>
                <option>En cours de rédaction</option>
                <option>Existant et appliquée</option>
              </select>
            </div>
            <div style="display:grid;gap:.4rem">
              <label for="polInvest" class="small" style="font-weight:700">Politique d’investissement / risque validée par le board</label>
              <select id="polInvest" name="Politique d’investissement / risque">
                <option value="">Sélectionner…</option>
                <option>Oui</option>
                <option>Non</option>
                <option>En cours de validation</option>
              </select>
            </div>
          </div>

          <div style="display:grid;gap:.4rem;margin-top:.75rem">
            <label for="frequenceComite" class="small" style="font-weight:700">Fréquence de revue en comité (audit / risques / board)</label>
            <select id="frequenceComite" name="Fréquence revue comité">
              <option value="">Sélectionner…</option>
              <option>Au fil de l’eau</option>
              <option>Trimestriel</option>
              <option>Annuel</option>
              <option>Non formalisé</option>
            </select>
          </div>
        </section>

        <!-- ========== ÉTAPE 5 : CONTEXTE & VALIDATION ========== -->
        <section class="wizard-step" data-step="5" aria-label="Étape 5 — Contexte & validation" tabindex="-1">
          <div class="label muted" style="margin-bottom:.4rem;display:flex;align-items:center;gap:.4rem">
            <span style="
              display:inline-flex;
              width:.5rem;
              height:.5rem;
              border-radius:999px;
              background:linear-gradient(120deg,#16a34a,#0f766e);
            "></span>
            <span>Étape 5/5 — Contexte &amp; validation</span>
          </div>
          <p class="muted small" style="margin-top:0;margin-bottom:1rem">
            Quelques lignes pour comprendre votre contexte et organiser la restitution.
          </p>

          <div style="display:grid;gap:.4rem">
            <label for="objectifPrioritaire" class="small" style="font-weight:700">Objectif prioritaire de la démarche</label>
            <select id="objectifPrioritaire" name="Objectif prioritaire">
              <option value="">Sélectionner…</option>
              <option>Réduire l’érosion de trésorerie (inflation)</option>
              <option>Structurer / mettre en conformité une exposition existante</option>
              <option>Préparer une décision stratégique pour le board</option>
              <option>Autre (préciser ci-dessous)</option>
            </select>
          </div>

          <div style="display:grid;gap:.4rem;margin-top:.75rem">
            <label for="comments" class="small" style="font-weight:700">Contexte &amp; objectifs internes</label>
            <textarea
              id="comments"
              name="Commentaires"
              placeholder="Ex : inflation sur le cash, pression des associés, préparation d’un onboarding PSAN, demande du commissaire aux comptes…"
              style="min-height:5rem"
              required
            ></textarea>
          </div>

          <div class="grid" style="gap:1rem;margin-top:.75rem">
            <div style="display:grid;gap:.4rem">
              <label for="visio" class="small" style="font-weight:700">Souhaitez-vous une visio de restitution (45 min) ?</label>
              <select id="visio" name="Visio restitution">
                <option>Oui, visio 45 min</option>
                <option>Non, envoi du rapport en priorité</option>
              </select>
            </div>
            <div style="display:grid;gap:.4rem">
              <label class="small" style="font-weight:700">Créneau préféré pour un échange</label>
              <div class="grid" style="gap:.4rem">
                <select id="jourCreneau" name="Jour préféré">
                  <option value="">Jour préféré (optionnel)</option>
                  <option>Lundi</option>
                  <option>Mardi</option>
                  <option>Mercredi</option>
                  <option>Jeudi</option>
                  <option>Vendredi</option>
                </select>
                <select id="plageCreneau" name="Plage horaire préférée">
                  <option value="">Plage horaire (optionnel)</option>
                  <option>9h–11h</option>
                  <option>11h–13h</option>
                  <option>14h–16h</option>
                  <option>16h–18h</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Récapitulatif synthétique -->
          <div id="wizardSummary" class="wizard-summary" aria-live="polite" style="margin-top:1rem">
            <!-- Contenu généré en JS -->
          </div>

          <!-- Opt-in & consentement -->
          <label class="small" style="display:flex;gap:.5rem;align-items:flex-start;margin-top:1rem">
            <input
              type="checkbox"
              id="optinMemo"
              name="Opt-in Mémo Numérion"
              style="margin-top:.15rem"
            />
            <span>
              Je souhaite recevoir le mémo Numérion Éducation™ (1 à 2 fois par mois) sur la trésorerie numérique,
              MiCA et cas pratiques (désinscription possible à tout moment).
            </span>
          </label>

          <label class="small" style="display:flex;gap:.5rem;align-items:flex-start;margin-top:.75rem">
            <input
              type="checkbox"
              id="consentAudit"
              name="Consentement"
              required
              style="margin-top:.15rem"
            />
            <span>
              Je confirme fournir des informations exactes, être en position de décision ou dûment mandaté,
              et comprendre que Numérion Éducation™ agit en cabinet d’intelligence financière
              (aucune détention de fonds, aucun ordre transmis).
            </span>
          </label>
        </section>

        <!-- NAVIGATION WIZARD -->
        <div class="wizard-nav">
          <button type="button" class="btn btn-light" id="wizardPrev" disabled>Étape précédente</button>
          <div class="small muted" id="wizardStepIndicator">Étape 1 sur 5</div>
          <button type="button" class="btn btn-dark" id="wizardNext">Étape suivante</button>
          <button type="submit" class="btn btn-green" id="wizardSubmit" style="display:none">
            Envoyer ma demande d'audit
          </button>
        </div>

        <div class="small muted" id="wizardStatus" role="status" aria-live="polite" style="margin-top:.5rem"></div>

        <!-- Bloc RGPD / confidentialité -->
        <p class="small muted" style="margin-top:.7rem;line-height:1.5">
          Données traitées par Numérion Éducation™ pour l’analyse de votre dossier et la prise de contact.
          Conservation maximale : 24 mois, sauf relation contractuelle prolongée. Vous pouvez exercer vos droits
          d’accès, de rectification et d’opposition en nous contactant à l’adresse indiquée dans nos mentions légales.
          L’analyse fournie constitue un diagnostic d’opportunité et de gouvernance et ne constitue pas un conseil en
          investissement personnalisé. Toute décision d’allocation relève de votre direction et de vos conseils habituels.
        </p>
      </form>
    </section>
  </div>

  <!-- ========== LOGIQUE WIZARD (navigation + validation + scoring) ========== -->
  <script>
    (function(){
      const form = document.getElementById('auditWizardForm');
      if (!form) return;

      const steps = Array.from(form.querySelectorAll('.wizard-step'));
      const progressFill = document.getElementById('wizardProgressFill');
      const labels = Array.from(document.querySelectorAll('.wizard-step-label'));
      const prevBtn = document.getElementById('wizardPrev');
      const nextBtn = document.getElementById('wizardNext');
      const submitBtn = document.getElementById('wizardSubmit');
      const indicator = document.getElementById('wizardStepIndicator');
      const statusNode = document.getElementById('wizardStatus');
      const summaryNode = document.getElementById('wizardSummary');

      const submitDateInput = document.getElementById('wizardSubmitDate');
      const sourceInput = document.getElementById('wizardSource');
      const maturityInput = document.getElementById('wizardMaturityScore');
      const segmentInput = document.getElementById('wizardSegment');

      let current = 0; // index

      // Source depuis l’URL (?source=...) ou valeur par défaut
      (function initSource(){
        try{
          const params = new URLSearchParams(window.location.search);
          const src = params.get('source') || 'Site Numérion Éducation';
          if(sourceInput) sourceInput.value = src;
        }catch(e){
          if(sourceInput) sourceInput.value = 'Site Numérion Éducation';
        }
      })();

      function updateUI(){
        steps.forEach((step,i)=>{
          step.classList.toggle('is-active', i === current);
        });
        labels.forEach((lbl,i)=>{
          lbl.classList.toggle('is-active', i === current);
        });

        const total = steps.length;
        const percent = ((current+1)/total)*100;
        if(progressFill) progressFill.style.width = percent + '%';
        if(indicator) indicator.textContent = `Étape ${current+1} sur ${total}`;
        prevBtn.disabled = current === 0;

        if(current === total-1){
          nextBtn.style.display = 'none';
          submitBtn.style.display = 'inline-flex';
          buildSummary();
        }else{
          nextBtn.style.display = 'inline-flex';
          submitBtn.style.display = 'none';
          if(summaryNode) summaryNode.innerHTML = '';
        }

        statusNode.textContent = '';

        // Focus sur l’étape active + scroll
        const activeStep = steps[current];
        if(activeStep){
          activeStep.setAttribute('tabindex','-1');
          activeStep.focus({preventScroll:true});
          const rect = form.getBoundingClientRect();
          const offset = window.pageYOffset + rect.top - 80;
          window.scrollTo({top: offset, behavior:'smooth'});
        }
      }

      function validateStep(index){
        const step = steps[index];
        if(!step) return true;
        const requiredFields = Array.from(step.querySelectorAll('[required]'));
        let valid = true;

        for(const field of requiredFields){
          field.setCustomValidity('');

          const isCheckbox = field.type === 'checkbox';
          const isEmpty = isCheckbox ? !field.checked : !field.value.trim();

          if(isEmpty){
            field.setCustomValidity('Champ requis');
          }

          if(!field.reportValidity()){
            valid = false;
            break;
          }
        }

        if(!valid){
          statusNode.textContent = "Certains champs sont manquants ou invalides à cette étape. Merci de les compléter.";
        }else{
          statusNode.textContent = '';
        }
        return valid;
      }

      function buildSummary(){
        if(!summaryNode) return;

        const nomSoc = document.getElementById('nomSoc')?.value || '';
        const role = document.getElementById('role')?.value || '';
        const secteur = document.getElementById('secteur')?.value || '';
        const taille = document.getElementById('taille')?.value || '';
        const tresoEst = document.getElementById('tresoEst')?.value || '';
        const alloc = document.getElementById('alloc')?.value || '';
        const horizon = document.getElementById('horizon')?.value || '';
        const urgence = document.getElementById('urgence')?.value || '';
        const objectif = document.getElementById('objectifPrioritaire')?.value || '';

        const items = [
          nomSoc ? `Entreprise : ${nomSoc}` : '',
          role ? `Rôle décisionnel : ${role}` : '',
          (secteur || taille) ? `Profil : ${secteur || 'Secteur non précisé'} · ${taille || 'Taille non précisée'}` : '',
          tresoEst ? `Trésorerie disponible estimée : ${tresoEst}` : '',
          alloc ? `Allocation crypto envisagée : ${alloc}` : '',
          horizon ? `Horizon de la poche : ${horizon}` : '',
          urgence ? `Niveau d’urgence : ${urgence}` : '',
          objectif ? `Objectif prioritaire : ${objectif}` : ''
        ].filter(Boolean);

        if(!items.length){
          summaryNode.innerHTML = '';
          return;
        }

        summaryNode.innerHTML = `
          <div class="wizard-summary-title">Résumé des points clés transmis</div>
          <ul class="wizard-summary-list">
            ${items.map(item => `<li>${item}</li>`).join('')}
          </ul>
          <p style="margin-top:.4rem">
            Ce résumé sera intégré à votre dossier afin de faciliter la lecture pour votre direction et vos auditeurs.
          </p>
        `;
      }

      function computeMaturityScore(){
        const maturity = document.getElementById('maturity')?.value || '';
        const exposition = document.getElementById('expositionActuelle')?.value || '';
        const urgence = document.getElementById('urgence')?.value || '';

        let score = 0;

        if(maturity === 'Aucune') score += 20;
        if(maturity === 'Partielle') score += 50;
        if(maturity === 'Complète') score += 80;

        if(exposition === 'Aucune exposition') score += 20;
        if(exposition === 'Exposition limitée & non structurée') score += 40;
        if(exposition === 'Exposition significative déjà en place') score += 60;

        if(urgence === 'Étude / cadrage interne') score += 10;
        if(urgence === 'Instruction board / comité déjà lancée') score += 25;
        if(urgence === 'Exécution dans les 30 jours') score += 40;

        score = Math.max(0, Math.min(100, score));
        if(maturityInput) maturityInput.value = String(score);
      }

      function computeSegment(){
        const secteur = document.getElementById('secteur')?.value || '';
        const taille = document.getElementById('taille')?.value || '';
        let segment = '';

        if(!secteur && !taille){
          segment = '';
        }else{
          segment = `${secteur || 'Secteur ND'} — ${taille || 'Taille ND'}`;
        }

        if(segmentInput) segmentInput.value = segment;
      }

      prevBtn.addEventListener('click', function(){
        if(current > 0){
          current--;
          updateUI();
        }
      });

      nextBtn.addEventListener('click', function(){
        if(!validateStep(current)) return;
        if(current < steps.length-1){
          current++;
          updateUI();
        }
      });

      form.addEventListener('submit', function(e){
        if(!validateStep(current)){
          e.preventDefault();
          return;
        }

        if(submitDateInput){
          submitDateInput.value = new Date().toISOString();
        }

        computeMaturityScore();
        computeSegment();
        buildSummary();

        statusNode.textContent = "Envoi sécurisé de votre demande d’audit…";
        // Laisser le submit se faire naturellement vers Formspree
      });

      updateUI();
    })();
  </script>
</body>
</html>
